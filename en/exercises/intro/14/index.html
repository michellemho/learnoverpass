<!DOCTYPE html><html xmlns="https://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us"><head><link href="https://gmpg.org/xfn/11" rel="profile"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"><title>Foreach Loops</title><link rel="stylesheet" href="//michellemho.github.io/learnoverpass//css/main.css"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png"><link href="/favicon.png" rel="icon"><link href='https://fonts.googleapis.com/css?family=Roboto:400,300,700' rel='stylesheet' type='text/css'><link href="" rel="alternate" type="application/rss+xml" title="LearnOverpass &middot; "/><meta name="description" content=""><meta name="keywords" content=""> </head><body><div class="exercise-contrib"><div> <a href="https://github.com/osmlab/learnoverpass/blob/master/CONTRIB.md">Contribute to project</a></div></div> <div class="menu-bar"><h1> <a href="//michellemho.github.io/learnoverpass//">LearnOverpass</a></h1></div><div class="exercise-container"><div class="exercise-lesson"><div class="exercise-lesson-bar"><div class="line">Intro</div></div><div class="exercise-lesson-inner"><div class="exercise-lesson-article"><h2> Foreach Loops  <a class="docs-improve" href="https://github.com/osmlab/learnoverpass/edit/master/content/en/exercises/intro/14.md">Improve page</a></h2> <p>Wonderful! You found 471 bikeshares in Boston and New York City. Now, hold on to your hats, because we&rsquo;re going to introduce a whole bunch of concepts here. We&rsquo;re going to count the number of Citi Bike stations in each New York City county. For this, we&rsquo;ll need to use a new function <code>map_to_area</code>, look for relations, and create a <code>foreach</code> loop. For good measure, we&rsquo;ll also output the results as a csv!</p>
</div><div class="exercise-lesson-instruction"><div class="exercise-lesson-label"> <span>Instructions</span></div> <ol>
<li>In line 1, the setting <code>[out:csv(::&quot;type&quot;,::&quot;id&quot;, name, ::&quot;count&quot;)];</code> makes the output a csv. The fields starting with <code>::</code> indicate an OSM special field.</li>
<li>In line 2, we&rsquo;re searching for an area. Go ahead and fill out &ldquo;New York City&rdquo;</li>
<li>In line 3, we&rsquo;re looking for the counties within our search area. US counties in OSM are relations tagged as <code>admin_level=6</code>. Fill in that line</li>
<li>In line 4, we&rsquo;re using <code>map_to_area</code>, which is a funky function. It&rsquo;s taking all the relations we found in the line above (the counties) and creating search areas out of them</li>
<li>In line 5, we&rsquo;re adding a <code>foreach</code> loop. The prefix <code>.d</code> tells the loop to assign the loop results into this new set <code>.d</code></li>
<li>Line 6 is simply printing out the results we currently have. Since we haven&rsquo;t done anything yet, this will simply return the counties we found.</li>
<li>In line 7, we&rsquo;re looking for the nodes within these areas now. Fill in the <code>bicycle_rental</code> for the tag.</li>
<li>Finally, we&rsquo;ll simply print out the count of these nodes and close the loop! Let&rsquo;s run it.</li>
</ol>
</div></div></div><div class="docs-repl exercise-main"><div class="editor-cover"></div> <textarea>[out:csv(::&#34;type&#34;,::&#34;id&#34;, name,::&#34;count&#34;)];
area[name=];
 relation(area)[admin_level= ];
 map_to_area;
 foreach-&gt;.d(
   (.d;);out;
   node(area.d)[amenity= ];
   out count;
 );
</textarea><div class="exercise-fail-msg"><div class="message"> <span class="warning">That doesn't seem right!</span> <span class="hint">Make sure to use parenthesis and close statements with semicolons.</span></div></div><div class="exercise-action-bar"><div class="exercise-action-bar-inner winner-bar"><div> <span>Awesome Work!</span> <a href="//michellemho.github.io/learnoverpass/en/exercises/intro/15/" class="exercise-action-next">Go to Next Lesson</a></div></div><div class="exercise-action-bar-inner"><div> <a href="#" class="exercise-action-run">Run Query</a> <a href="#" class="exercise-action-reset">Reset Code</a></div></div></div><div class="docs-repl-result output"><iframe src="https://overpass-turbo.eu/master/map.html" seamless="seamless" frameBorder="0"></iframe><textarea></textarea> <a class="docs-repl-change-output button" href="#">Data</a></div></div><div class="exercise-answer">[out:csv(::&#34;type&#34;,::&#34;id&#34;, name,::&#34;count&#34;)];
area[name=&#34;New York City&#34;];
 relation(area)[admin_level=6];
 map_to_area;
 foreach-&gt;.d(
   (.d;);out;
   node(area.d)[amenity=bicycle_rental];
   out count;
 );
</div><div class="exercise-regex"></div></div> <script src="//michellemho.github.io/learnoverpass//js/vendor.bundle.js"></script> <script src="//michellemho.github.io/learnoverpass//js/exercise.bundle.js"></script> </body></html>